"Bronson":
    type: assignment
    actions:
      on assignment:
      - trigger name:CHAT toggle:false
      - trigger name:click toggle:true
      - trigger name:proximity toggle:true radius:3

    interact scripts:
    - 18 Bronsonpeletero
    - 16 bronsonscript

'Bronsonpeletero':
  Type: Interact
  # Requirements:
  #   Mode: all
  #   List:
  #   - valueof <global.flag[capitulos].contains[destroy]>
  #   - valueof <player.flag[misiones].contains[destroy]>
  #   - -valueof <global.flag[capitulos].contains[mesreconstruido]>
  Steps:
    '1':
      proximity trigger:
        entry:
          radius: 4
          Script:
          - ^if <player.has_flag[profesion].not> {
            - ^actionbar "<gold>Bronson: <yellow>Largo de aqui!"
            - ^queue clear
            } else if <player.flag[profesion].as_list> !contains Ganadero && <player.has_flag[profesion]> {
            - ^actionbar "<gold>Bronson: <yellow>Se te perdio algo malnacido?"
            - ^wait 2
            - ^actionbar "<gold>Bronson: <yellow>Largo mugroso <dark_purple><player.flag[profesion].get[1]>..."
            - ^wait 2
            - ^actionbar "<gold>Bronson: <yellow>Almenos que quieras ver mas de cerca la cierra haha!"
            - ^queue clear
            } else if <player.flag[profesion].as_list> contains Ganadero && <player.has_flag[profesion]> && <player.flag[profesion].as_list> !contains Peletero {
            - ^actionbar "<gold>Bronson: <yellow>Bienvenido <player.name>!"
            - ^wait 2
            - ^actionbar "<gold>Bronson: <yellow>Quieres desollar animales?"
            - ^wait 2
            - ^actionbar "<gold>Bronson: <yellow>Conseguiras buenas pieles!"
            - ^queue clear
            } else if <player.flag[profesion].as_list> contains Ganadero && <player.has_flag[profesion]> && <player.flag[profesion].as_list> contains Peletero {
            - ^actionbar "<gold>Bronson: <yellow>Hey <player.name>!"
            - ^wait 2
            - ^actionbar "<gold>Bronson: <yellow>Que vamos a desollar esta ves!"
            - ^queue clear
            }
      click trigger:
        Script:
          - ^if <player.flag[profesion].as_list> contains Ganadero && <player.flag[profesion].as_list> !contains Peletero && <player.has_flag[profesion]> {
            - ^inventory open d:in@inv_bronson
            - ^queue clear
            } else if <player.flag[profesion].as_list> contains Ganadero && <player.flag[profesion].as_list> contains Peletero && <player.has_flag[profesion]> {
            - ^inventory open d:in@inv_bronson_ok
            }
bronson_craft1task:
    type: task
    script:
    - ^foreach li@i@cadaberdepollo|i@navajahueso {
      - ^flag <player> <def[value].replace[regex:i@]>:<player.inventory.quantity[%value%]> duration:1s
      }
    - ^queue clear
bronson_craft2task:
    type: task
    script:
    - ^foreach li@i@pellejodepollo|i@navajahueso {
      - ^flag <player> <def[value].replace[regex:i@]>:<player.inventory.quantity[%value%]> duration:1s
      }
    - ^queue clear
bronsonevents:
  type: world
  events:
    on player clicks in inv_bronson:
    - DETERMINE cancelled
    on player drags in inv_bronson:
    - DETERMINE cancelled
    on player clicks in inv_bronson_ok:
    - DETERMINE cancelled
    on player drags in inv_bronson_ok:
    - DETERMINE cancelled
    on player clicks in inv_bronson_craft1:
    - DETERMINE cancelled
    on player drags in inv_bronson_craft1:
    - DETERMINE cancelled
    on player clicks in inv_bronson_craft2:
    - DETERMINE cancelled
    on player drags in inv_bronson_craft2:
    - DETERMINE cancelled
#
    on player clicks rechazarprof in inv_bronson:
    - ^inventory close d:in@inv_bronson
    on player clicks aceptarprof in inv_bronson:
    - ^inventory close d:in@inv_bronson
    - ^if <player.flag[profesion].as_list> contains Carnicero {
      - ^flag <player> profesion:<-:Carnicero
      - ^execute as_op "jobs leave Carnicero" silent
      }
    - ^execute as_op "jobs employ <player.name> Peletero" silent
    - ^flag <player> profesion:->:Peletero
    - ^queue clear
#  Listas de Crafteo
    on player clicks pellejoslist in inv_bronson_ok:
    - ^run 's@bronson_craft1task'
    - ^inventory open d:in@inv_bronson_craft1
    - ^queue clear
    on player clicks mochilaslist in inv_bronson_ok:
    - ^run 's@bronson_craft2task'
    - ^inventory open d:in@inv_bronson_craft2
    - ^queue clear
#  Crafteo de Items
#  -- Pellejos
    on player right clicks pellejopolloinfo in inv_bronson_craft1:
    - ^if <player.inventory.quantity[i@cadaberdepollo]> >= 2 && <player.inventory.quantity[i@navajahueso]> >= 1 {
      - ^inventory close d:in@inv_bronson_craft1
      - ^actionbar "<gold>Bronson: <yellow>Creando... <player.name>"
      - ^wait 2
      - ^actionbar "<gold>Bronson: <yellow>Ya casi!"
      - ^wait 1
      - ^give i@pellejodepollo quantity:1
      - ^take i@cadaberdepollo quantity:2
      - ^take i@navajahueso quantity:1
      - ^run 's@bronson_craft1task'
      - ^inventory open d:in@inv_bronson_craft1
      - ^execute as_server "jobs grantxp <player.name> Peletero 10" silent
      }
    - ^queue clear
#  -- Pellejos
    on player right clicks mochilasinfo in inv_bronson_craft2:
    - ^if <player.inventory.quantity[i@pellejodepollo]> >= 14 {
      - ^inventory close d:in@inv_bronson_craft2
      - ^actionbar "<gold>Bronson: <yellow>Creando... <player.name>"
      - ^wait 2
      - ^actionbar "<gold>Bronson: <yellow>Ya casi!"
      - ^wait 1
      - ^give i@mochilat1 quantity:1
      - ^take i@pellejodepollo quantity:14
      - ^run 's@bronson_craft2task'
      - ^inventory open d:in@inv_bronson_craft2
      - ^execute as_server "jobs grantxp <player.name> Peletero 10" silent
      }
    - ^queue clear

  ## Atras
    on player clicks Atras in inv_bronson_craft1:
    - ^inventory open d:in@inv_bronson_ok
    on player clicks Atras in inv_bronson_craft2:
    - ^inventory open d:in@inv_bronson_ok
# =====================================================================
    on player clicks rechazarprof in inv_bronson_ok:
    - ^inventory close d:in@inv_bronson_ok
    - ^DETERMINE cancelled


# = INVENTARIOS
inv_bronson:
  type: inventory
  inventory: dispenser
  title: <gold>Peleteria
  size: 9
  slots:
  - "[i@cancelslot] [i@bronsoninfo1] [i@cancelslot]"
  - "[i@cancelslot] [i@cancelslot] [i@cancelslot]"
  - "[i@aceptarprof] [i@cancelslot] [i@rechazarprof]"
inv_bronson_ok:
  type: inventory
  title: '<dark_purple><magic>0<reset><gold>Peleteria<dark_purple><magic>0'
  size: 9
  slots:
  - "[i@pellejoslist] [i@mochilaslist] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot]"
inv_bronson_craft1:
  type: inventory
  title: '<dark_purple><magic>0<reset><gold>Pellejos<dark_purple><magic>0'
  size: 9
  slots:
  - "[i@pellejopolloinfo] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@Atras]"
inv_bronson_craft2:
  type: inventory
  title: '<dark_purple><magic>0<reset><gold>Pellejos<dark_purple><magic>0'
  size: 9
  slots:
  - "[i@mochilasinfo] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@cancelslot] [i@Atras]"


########### - bronson - #########
bronsoninfo1:
  type: item
  material: paper
  display name: '<blue>Peletero'
  lore:
  - ''
  - '<gray>Los <yellow>Peleteros <gray>desollan animales'
  - '<gray>para poder extraer su piel y grasas'
  - '<gray>creando cosas magnificas'
#---------------------------------------------ITEMS----------------------------------------------------
#----Pellejos
pellejoslist:
  type: item
  material: 415
  display name: '<gold>Lista de Pellejos'
#----Mochilas
mochilaslist:
  type: item
  material: 2261
  display name: '<gold>Lista de Mochilas'
#
# Mochilas info
mochilasinfo:
  type: item
  material: 2261
  display name: '<dark_green>Mochilas'
  lore:
  - '<yellow>Requiere:'
  - '<gray>Nivel para craftear: <yellow>1'
  - '<gray>Pellejos de pollo: <yellow>14'
  - ''
  - '<gold>Materiales actuales:'
  - '<yellow><player.flag[pellejodepollo].asint><&pipe>14<gray> Cadaber de pollo <dark_gray>(Peletero)'
  - ''
  - '<green>Click <dark_green>derecho<green> para crear'
# Pellejos info
pellejopolloinfo:
  type: item
  material: 415
  display name: '<dark_green>Pellejo de pollo'
  lore:
  - '<yellow>Requiere:'
  - '<gray>Nivel para craftear: <yellow>1'
  - '<gray>Cadaber de pollo: <yellow>2'
  - '<gray>Navaja de Hueso: <yellow>1'
  - ''
  - '<gold>Materiales actuales:'
  - '<yellow><player.flag[cadaberdepollo].asint><&pipe>2<gray> Cadaber de pollo <dark_gray>(Ganadero)'
  - '<yellow><player.flag[navajahueso].asint><&pipe>1<gray> Navaja de Hueso <dark_gray>(Carnicero)'
  - ''
  - '<green>Click <dark_green>derecho<green> para crear'
